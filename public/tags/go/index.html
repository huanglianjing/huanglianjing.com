<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Go | My New Hugo Site</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="author" content="">
<link rel="canonical" href="http://example.org/tags/go/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css" integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe&#43;FVUFzPh7U=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://example.org/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://example.org/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://example.org/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://example.org/apple-touch-icon.png">
<link rel="mask-icon" href="http://example.org/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://example.org/tags/go/index.xml">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Go" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://example.org/tags/go/" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Go"/>
<meta name="twitter:description" content=""/>

</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://example.org/" accesskey="h" title="My New Hugo Site (Alt + H)">My New Hugo Site</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header">
  <h1>
    Go
  </h1>
</header>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Go Pprof性能分析
    </h2>
  </header>
  <div class="entry-content">
    <p>1. 简介 pprof 是 go 自带的一个对程序的性能进行可视化和分析的工具，它从 profile.proto 格式的采样数据集中读取数据，并生成可视化报告，帮助我们分析我们的程序性能，进而有所针对进行优化。
当服务在运行时，有时候会遇到内存占用越来越大、将机器的CPU占满、goroutine数量暴涨的情况，或者当我们准备针对已有的代码进行运行效率、内存占用等方面进行优化，这时候就是 pprof 可以派上用场的时候了。
pprof 的采集方式分为以下几种：
runtime/pprof：采集程序指定区块的运行数据，生成 profile.proto 文件并对其进行分析。 net/http/pprof：基于 HTTP Server 运行，并且可以采集运行时数据进行分析。 go test：通过运行测试用例，并指定所需标识来进行采集。 pprof 可以分析包含以下几种：
CPU Profiling：CPU 分析，按照一定的频率采集所监听的应用程序 CPU（含寄存器）的使用情况，可确定应用程序在主动消耗 CPU 周期时花费时间的位置。 Memory Profiling：内存分析，在应用程序进行堆分配时记录堆栈跟踪，用于监视当前和历史内存使用情况，以及检查内存泄漏。 Goroutine Profiling： Goroutine 分析，可以对当前应用程序正在运行的 Goroutine 进行堆栈跟踪和分析。 Mutex Profiling：互斥锁分析，报告互斥锁的竞争情况。 Block Profiling：阻塞分析，记录协程阻塞等待同步的情况。 采集后支持通过生成报告、终端命令行、Web界面的形式进行分析。
2. 使用方式 2.1 net/http/pprof 端口监听 该方式适合于服务型应用，通过添加监听端口，采集 HTTP Server 运行时的数据进行分析。
代码示例：开启一个协程监听一个端口，然后对一个字符串不断地追加内容。
package main import ( &#34;log&#34; &#34;net/http&#34; _ &#34;net/http/pprof&#34; &#34;time&#34; ) var datas []string func main() { go func() { _ = http....</p>
  </div>
  <footer class="entry-footer"><span title='2023-07-25 01:52:12 +0800 CST'>July 25, 2023</span></footer>
  <a class="entry-link" aria-label="post link to Go Pprof性能分析" href="http://example.org/posts/go-pprof%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Go Modules：Go的包管 理
    </h2>
  </header>
  <div class="entry-content">
    <p>1. Go Modules介绍 Go Modules是Go管理包的依赖的工具，自Go 1.11加入，以解决Go的依赖管理问题，淘汰了旧的GOPATH模式。
旧的GOPATH模式将代码存放在GOPATH/src目录下，通过go get来下载外部依赖包。但是GOPATH模式没有版本控制的概念，无法确保下载的依赖包是期望的版本。因此引入了Go Modules解决这些问题。
2. 使用Go Modules 首先要确保Go升级到了1.11或以上版本。
然后是设置GO111MODULE，GO111MODULE有三个值：off、on和auto（默认值）。
GO111MODULE=off：不支持modules功能，通过GOPATH来查找依赖包。 GO111MODULE=on：使用modules，完全不会通过GOPATH来查找依赖包。 GO111MODULE=auto：根据当前目录决定是否启用modules，当前目录在GOPATH/src之外，且包含go.mod文件或在包含go.mod文件的目录下面，就会启用modules。 设置GO111MODULE：
$ go env -w GO111MODULE=on # 设置GO111MODULE 当启用modules功能时，依赖包存放位置在GOPATH/pkg/mod，并且允许同一个package的多个版本并存，供项目指定引用。
3. go mod go mod带有多个命令，且会在项目中生成和维护go.mod、go.sum两个文件。
3.1 go.mod Go提供了go mod命令来管理包。
新建目录并初始化生成go.mod文件：
$ mkdir hehe $ cd hehe $ go mod init hehe # 初始化go.mod文件 新建go.mod后，当其他源文件引用了任何包时，go get、go build、go mod等命令都会更新go.mod文件，并会自动下载用到的依赖包。
生成的go.mod内容示例如下：
module hehe go 1.15 require ( github.com/labstack/echo v3.3.10&#43;incompatible // indirect github.com/mattn/go-colorable v0.1.1 github.com/mattn/go-isatty v0.0.7 ) exclude ( go....</p>
  </div>
  <footer class="entry-footer"><span title='2023-07-25 01:52:02 +0800 CST'>July 25, 2023</span></footer>
  <a class="entry-link" aria-label="post link to Go Modules：Go的包管 理" href="http://example.org/posts/go-modulesgo%E7%9A%84%E5%8C%85%E7%AE%A1%E7%90%86/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Go安装和使用
    </h2>
  </header>
  <div class="entry-content">
    <p>1. 安装 1.1 CentOS安装Go $ yum install golang 1.2 macOS安装Go macOS 可以通过 brew 安装 Go，需要先安装 brew。
$ brew install go 2. 工具 Go的工具链通过go命令配合子命令使用。
常用命令：
build 编译包和依赖 clean 删除目标文件 doc 显示文档 env 显示go环境变量 fmt 格式化代码 get 下载安装包和依赖 install 编译安装包和依赖 list 列出包 run 编译运行程序 test 测试包 version 显示go版本信息 vet 运行工具vet 执行工具：
$ go [commant] // 执行工具 $ go help [commant] // 查看工具文档 2.1 env 显示Go环境变量。
$ go env # 显示所有Go环境变量 $ go env GOPATH # 显示某个环境变量 $ go env -w GO111MODULE=on # 设置Go环境变量 $ go env -u GOPROXY # 取消env配置 GOPATH...</p>
  </div>
  <footer class="entry-footer"><span title='2023-07-25 01:51:34 +0800 CST'>July 25, 2023</span></footer>
  <a class="entry-link" aria-label="post link to Go安装和使用" href="http://example.org/posts/go%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Go标准库：reflect
    </h2>
  </header>
  <div class="entry-content">
    <p>1. 介绍 文档地址：https://pkg.go.dev/reflect
Go 标准库 reflect 用于运行时的映射，使程序运行时可以检查和操纵任意类型的对象。例如，在运行时获取一个任意类型 interface{} 的对象，并获取它的动态类型。
获取对象的类型并使用不同的取值方法：
for _, v := range []any{&#34;hi&#34;, 42, func() {}} { switch v := reflect.ValueOf(v); v.Kind() { case reflect.String: fmt.Println(v.String()) case reflect.Int, reflect.Int8, reflect.Int16, reflect.Int32, reflect.Int64: fmt.Println(v.Int()) default: fmt.Printf(&#34;unhandled kind %s&#34;, v.Kind()) } } 获取变量的类型：
var x int typ := reflect.TypeOf(x) fmt.Println(typ) 根据函数名调用对应函数：
func add(a int, b int) int { return a &#43; b } var FuncMap = map[string]interface{}{ &#34;add&#34;: add, } funcName := &#34;add&#34; f := reflect....</p>
  </div>
  <footer class="entry-footer"><span title='2023-07-25 01:51:34 +0800 CST'>July 25, 2023</span></footer>
  <a class="entry-link" aria-label="post link to Go标准库：reflect" href="http://example.org/posts/go%E6%A0%87%E5%87%86%E5%BA%93reflect/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Go标准库：strconv
    </h2>
  </header>
  <div class="entry-content">
    <p>1. 介绍 文档地址：https://pkg.go.dev/strconv
Go 标准库 strconv 用于字符串和其他类型的相互转化。
数字转化示例：
// 字符串转整数 i, err := strconv.Atoi(&#34;-42&#34;) // 整数转字符串 s := strconv.Itoa(-42) // 字符串转int，指定进制和位数 i, err := strconv.ParseInt(&#34;-42&#34;, 10, 64) // 数字转字符串 s := strconv.FormatInt(-42, 16) 2. 常量与变量 // IntSize int和uint的位数 const IntSize = intSize // ErrRange 值超出范围 var ErrRange = errors.New(&#34;value out of range&#34;) // ErrSyntax 语法错误 var ErrSyntax = errors.New(&#34;invalid syntax&#34;) 3. 函数 // Atoi string转int func Atoi(s string) (int, error) // Itoa int转string func Itoa(i int) string // 其他类型转string func FormatBool(b bool) string func FormatComplex(c complex128, fmt byte, prec, bitSize int) string func FormatFloat(f float64, fmt byte, prec, bitSize int) string func FormatInt(i int64, base int) string func FormatUint(i uint64, base int) string // string转其他类型 func ParseBool(str string) (bool, error) func ParseComplex(s string, bitSize int) (complex128, error) func ParseFloat(s string, bitSize int) (float64, error) func ParseInt(s string, base int, bitSize int) (i int64, err error) func ParseUint(s string, base int, bitSize int) (uint64, error) </p>
  </div>
  <footer class="entry-footer"><span title='2023-07-25 01:51:34 +0800 CST'>July 25, 2023</span></footer>
  <a class="entry-link" aria-label="post link to Go标准库：strconv" href="http://example.org/posts/go%E6%A0%87%E5%87%86%E5%BA%93strconv/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Go标准库：strings
    </h2>
  </header>
  <div class="entry-content">
    <p>1. 介绍 文档地址：https://pkg.go.dev/strings
Go 标准库 strings 用于字符串相关的操作。
2. 类型 2.1 Builder 类型定义：
// Builder 字符串构建器 type Builder struct { // contains filtered or unexported fields } 方法：
// Cap 容量大小 func (b *Builder) Cap() int // Grow 增加容量 func (b *Builder) Grow(n int) // Len 字符串长度 func (b *Builder) Len() int // Reset 清空 func (b *Builder) Reset() // 返回现有的字符串 func (b *Builder) String() string // 追加内容 func (b *Builder) Write(p []byte) (int, error) func (b *Builder) WriteString(s string) (int, error) 2....</p>
  </div>
  <footer class="entry-footer"><span title='2023-07-25 01:51:34 +0800 CST'>July 25, 2023</span></footer>
  <a class="entry-link" aria-label="post link to Go标准库：strings" href="http://example.org/posts/go%E6%A0%87%E5%87%86%E5%BA%93strings/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Go标准库：time
    </h2>
  </header>
  <div class="entry-content">
    <p>1. 介绍 文档地址：https://pkg.go.dev/time
Go 标准库 time 用于测量和展示时间。
一个计算代码耗时的例子：
start := time.Now() // do sth. end := time.Now elapsed := end.Sub(start) 2. 常量 时间单位常量：
const ( Nanosecond Duration = 1 Microsecond = 1000 * Nanosecond Millisecond = 1000 * Microsecond Second = 1000 * Millisecond Minute = 60 * Second Hour = 60 * Minute ) 月份常量：
const ( January Month = 1 &#43; iota February March April May June July August September October November December ) 星期常量：...</p>
  </div>
  <footer class="entry-footer"><span title='2023-07-25 01:51:34 +0800 CST'>July 25, 2023</span></footer>
  <a class="entry-link" aria-label="post link to Go标准库：time" href="http://example.org/posts/go%E6%A0%87%E5%87%86%E5%BA%93time/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Go标准库：context
    </h2>
  </header>
  <div class="entry-content">
    <p>1. 介绍 文档地址：https://pkg.go.dev/context
Go 标准库 context 用于在函数调用、API调用、进程调用间传递上下文。
Go官方建议不要将 context 定义在其他结构体中，将 context 作为独立的参数传递给需要的函数且应该是首个参数，变量名一般使用 ctx。示例如下：
func DoSomething(ctx context.Context, arg Arg) error { // ... use ctx ... } context 在多个协程中同时使用是安全的。
2. 类型 2.1 Context 类型定义：
// Context 上下文 type Context interface { Deadline() (deadline time.Time, ok bool) // 被取消的时间 Done() &lt;-chan struct{} // 返回一个通道，context被取消时关闭 Err() error // Done未关闭时返回nil，关闭时返回关闭原因 Value(key any) any // 获取key对应的val } 方法：
// Background 返回一个空的context，不会被取消，没有值，没有deadline，通常用于主函数、初始化、测试、最上层接收请求时 func Background() Context // TODO 返回一个空的context，不确定会用到context时使用 func TODO() Context // WithValue 返回父context的复制，并关联key-val func WithValue(parent Context, key, val any) Context 2....</p>
  </div>
  <footer class="entry-footer"><span title='2023-07-25 01:51:33 +0800 CST'>July 25, 2023</span></footer>
  <a class="entry-link" aria-label="post link to Go标准库：context" href="http://example.org/posts/go%E6%A0%87%E5%87%86%E5%BA%93context/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Go标准库：errors
    </h2>
  </header>
  <div class="entry-content">
    <p>1. 介绍 文档地址：https://pkg.go.dev/errors
Go 标准库 errors 用于操作error。
如果一个error e包含以下任一方法，则可以包裹另一个error。
Unwrap() error Unwrap() []error 自定义error结构体示例：
type MyError struct { When time.Time What string } func (e MyError) Error() string { return fmt.Sprintf(&#34;%v: %v&#34;, e.When, e.What) } err := MyError{ time.Date(1989, 3, 15, 22, 30, 0, 0, time.UTC), &#34;the file system has gone away&#34;, } fmt.Println(err) 2. 函数 // New 创建error func New(text string) error // As err是否和target类型匹配，如果是则设置target的内容 func As(err error, target any) bool // Is err是否和target类型匹配 func Is(err, target error) bool // Join 将多个error包裹起来 func Join(errs ....</p>
  </div>
  <footer class="entry-footer"><span title='2023-07-25 01:51:33 +0800 CST'>July 25, 2023</span></footer>
  <a class="entry-link" aria-label="post link to Go标准库：errors" href="http://example.org/posts/go%E6%A0%87%E5%87%86%E5%BA%93errors/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Go标准库：fmt
    </h2>
  </header>
  <div class="entry-content">
    <p>1. 介绍 文档地址：https://pkg.go.dev/fmt
Go 标准库之 fmt 包实现了格式化 IO，也就是类似于 C 语言的 printf 和 scanf 方式的格式化。
控制格式化的字符串中，以百分号（%）作为格式的通配符，后面跟着不同的字母表示不同的类型格式。例如 %d 表示10进制整数，于是有以下例子：
import &#34;fmt&#34; func fmtTest() { i := 23 str := &#34;good&#34; fmt.Printf(&#34;%d:%s\n&#34;, i, str) } /* 输出结果 23:good */ %d 表示一个10进制整数，而 fmt.Printf() 方法在它的首个格式化字符串参数中找到它后，就从后续的参数里取到变量 i，将变量 i 的值输出到 %d 所占的位置。如果格式化字符串中包含多个以 % 表示的格式，就会依次从后面的参数中取参数值以格式所对应的类型，输出到那个位置。
2. 格式 通用格式：
%v 任何值的默认格式，对于结构体只会显示每个成员的值 %&#43;v 对于结构体还会显示每个成员的字段名称 %#v Go语法的值，还会显示结构体的类型名 %T 值的类型 %% 表示百分号% 使用 %v 对于一些复合结构所打印的格式如下：
struct: {field0 field1 ...} array, slice: [elem0 elem1 ....</p>
  </div>
  <footer class="entry-footer"><span title='2023-07-25 01:51:33 +0800 CST'>July 25, 2023</span></footer>
  <a class="entry-link" aria-label="post link to Go标准库：fmt" href="http://example.org/posts/go%E6%A0%87%E5%87%86%E5%BA%93fmt/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="next" href="http://example.org/tags/go/page/2/">Next&nbsp;&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="http://example.org/">My New Hugo Site</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
